# .github/workflows/fetch_docs.yml in Repo A
name: Fetch Docs from Repo B aka testing

on:
  repository_dispatch:
    types: [docs-update] # Must match the event-type sent from Repo B

jobs:
  fetch_docs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout current repository (Repo A)
        uses: actions/checkout@v4

      - name: Display Trigger Info from Repo B
        run: |
          echo "Workflow triggered by repository_dispatch event."
          echo "Event type: ${{ github.event.action }}" # This will be 'docs-update'
          echo "Ref from Repo B: ${{ github.event.client_payload.ref }}"
          echo "SHA from Repo B: ${{ github.event.client_payload.sha }}"
          echo "Repository that triggered (from payload): ${{ github.event.client_payload.source_repo_full_name }}" # <--- CHANGED THIS LINE
          echo "Current repository (Repo A where workflow is running): ${{ github.repository.full_name }}" # Optional: to differentiate clearly

      - name: Checkout docs from Repo B
        uses: actions/checkout@v4
        with:
          repository: salomob-dynasafe/testing
          path: ./temp_repo_b # Checkout Repo B into a temporary directory
          token: ${{ secrets.PAT_TESTING }} # PAT with read access to Repo B

      - name: Copy docs directory
        run: |
          ls -halt
          cd ./temp_repo_b
          ls -halt
